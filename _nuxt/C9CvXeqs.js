import F from"./DciEt2cn.js";import{P as m,z as G,A as L,B as j,C as v,G as z,D as k,E as H,a as J,r as d,w as K,o as O,d as p,m as _,F as Q,e as t,g as x,h as g,t as N,i as r,H as W,I as X,j as Y,f as Z,J as tt,K as et,L as $}from"./D0yDvV06.js";async function st(){const n=m(),a=[];return(await G(L(n,"articles"))).forEach(i=>{const u={data:i.data(),id:i.id};a.push(u)}),a}async function at(n,a){const o=m(),i=Math.floor(Math.random()*10000001);await j(v(o,"articles",`${i}`),{title:a,id:i,visible:!0,content:n,createAt:z()})}async function ot(n,a,o){const i=m(),u=v(i,"articles",`${o}`);await k(u,{title:a,content:n})}async function nt(n){const a=m();await H(v(a,"articles",`${n}`))}async function it(n){const a=m(),o=v(a,"articles",`${n}`);await k(o,{visible:!1})}async function lt(n){const a=m(),o=v(a,"articles",`${n}`);await k(o,{visible:!0})}const ct={class:"s-admin"},dt={class:"s-admin__container l-wide"},rt={class:"s-admin__block"},ut={class:"s-admin__main _border"},_t={class:"s-admin__row"},mt={class:"s-admin__row"},pt={class:"s-admin__aside _border"},vt={class:"s-admin__box _content"},ft={class:"s-admin__box-items"},bt={class:"s-admin__box-item-title"},wt={class:"s-admin__box-item-logic"},ht=["onClick"],At=["onClick"],yt=["onClick"],kt=["onClick"],gt={__name:"s-admin",setup(n){const a=J(),o=d(!1),i=d(!1),u=d([]),b=d([]),C=d(!0),w=d(!1),l=d(""),h=d(""),f=d(""),S=async s=>{await at(s,l.value),l.value="",h.value="",o.value=!0},B=s=>{b.value=u.value.find(e=>e.id===s),l.value=b.value.data.title,h.value=b.value.data.content,f.value=s,C.value=!1},D=async s=>{await ot(s,l.value,f.value),o.value=!0},P=async s=>{await it(s),location.reload()},I=async s=>{await lt(s),location.reload()},V=async s=>{f.value=s,i.value=!0},M=async()=>{await nt(f.value),i.value=!1,location.reload()};async function R(){const s=await st();u.value=s.sort((e,A)=>e.data.createAt-A.data.createAt)}const U=()=>{o.value=!1,location.reload()},q=()=>{i.value=!1};return K(()=>l.value,()=>{l.value!==""?w.value=!1:w.value=!0},{deep:!0,immediate:!0}),O(()=>{R()}),(s,e)=>{const A=F,E=$("s-popup-info"),T=$("s-popup-alert");return _(),p("section",ct,[Q(N(r(a))+" ",1),t("div",dt,[e[5]||(e[5]=t("h1",{class:"s-admin__title s-title"},"Админ панель",-1)),t("div",rt,[t("div",ut,[e[3]||(e[3]=t("h2",{class:"s-admin__subtitle"},"Основная информация:",-1)),t("div",_t,[e[1]||(e[1]=t("h3",{class:"s-admin__row-title"},"Название:",-1)),W(t("input",{"onUpdate:modelValue":e[0]||(e[0]=c=>Y(l)?l.value=c:null),class:"s-admin__input",placeholder:"Заголовок статьи"},null,512),[[X,r(l)]])]),t("div",mt,[e[2]||(e[2]=t("h3",{class:"s-admin__row-title"},"Основной текст:",-1)),Z(A,{"item-content":r(h),"create-or-update":r(C),"disabled-button":r(w),onSetNewArticle:S,onUpdateArticle:D},null,8,["item-content","create-or-update","disabled-button"])])]),t("div",pt,[t("div",vt,[e[4]||(e[4]=t("h2",{class:"s-admin__subtitle"},"Все статьи:",-1)),t("div",ft,[(_(!0),p(tt,null,et(r(u),c=>(_(),p("div",{key:c.id,class:"s-admin__box-item"},[t("h3",bt,N(c.data.title),1),t("div",wt,[t("div",{class:"s-admin__box-item-action _green",onClick:y=>B(c.id)}," Р ",8,ht),c.data.visible?(_(),p("div",{key:0,class:"s-admin__box-item-action _brown",onClick:y=>P(c.id)}," С ",8,At)):(_(),p("div",{key:1,class:"s-admin__box-item-action _brown _hidden",onClick:y=>I(c.id)}," С ",8,yt)),t("div",{class:"s-admin__box-item-action _red",onClick:y=>V(c.id)}," У ",8,kt)])]))),128))])])])])]),r(o)?(_(),x(E,{key:0,onClosePopup:U})):g("",!0),r(i)?(_(),x(T,{key:1,onClosePopup:q,onDeleteItem:M})):g("",!0)])}}};export{gt as default};
