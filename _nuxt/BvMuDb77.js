import R from"./Dn36USMj.js";import L from"./C7WxvSmc.js";import W from"./DiBxvqu6.js";import{S as Z,a as j,U as z,b as H,u as X,r as i,c as Y,w as $,d as U,m as f,e as s,f as A,t as c,i as t,v as q,h as G,H as E,I as J,y as I,j as F,V as K,g as M,W as O,X as Q,Y as ee}from"./D0yDvV06.js";const se={class:"s-auth"},ae={class:"s-auth__container l-wide"},te={class:"s-auth__top"},oe={class:"s-auth__center"},re={class:"s-auth__main"},le={class:"s-auth__title"},ie={class:"s-auth__formbox"},ne={class:"s-auth__form-label"},ue=["placeholder"],ce={class:"s-auth__form-label"},_e=["type","placeholder"],me={type:"submit",class:"s-auth__form-button"},de={key:0,class:"s-auth__form-error"},he={class:"s-auth__form-error-text"},fe={class:"s-auth__changebox"},pe={class:"s-auth__text"},ve={class:"s-auth__bottom"},$e={__name:"s-auth",setup(ge){const g=Z(),T=Q(),o=j(),y=z(),w=H("userInformation",{default:()=>null,watch:"shallow"}),{t:p,locale:b}=X();let n=i(!0),a=i(""),r=i(""),v=i(!1),_=i(!1),m=i(!1),d=i("");const D=()=>n.value=!n.value,x=async()=>{const e=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i;a.value&&!e.test(a.value)&&(_.value=!0),r.value.length<6&&(m.value=!0),!_.value&&!m.value&&(n.value==!0?V():C())},C=async()=>{try{const e=await ee(g,a.value,r.value);o.setUser(a.value,e.user.uid),o.setUserInMemory(!0),o.setLang(b.value),o.setTheme("day"),o.setTab("main");const l={email:a.value,id:e.user.uid,maxAge:60*60*24*7};w.value=l}catch(e){v.value=!0,e.message==="Firebase: Error (auth/email-already-in-use)."?d.value=p("form.errorMail"):console.error(`Ошибка: ${e.message}`)}},V=async()=>{try{const e=await O(g,a.value,r.value);o.setUser(a.value,e.user.uid),o.setUserInMemory(!0),o.setLang(b.value),o.setTheme("day"),o.setTab("main");const l={email:a.value,id:e.user.uid,maxAge:60*60*24*7};w.value=l,e.user.uid===T.public.ADMIN_ID?y.push({path:"/admin"}):y.push({path:"/"})}catch(e){v.value=!0,e.message==="Firebase: Error (auth/email-already-in-use)."?d.value=p("form.errorMail"):e.message==="Firebase: Error (auth/invalid-login-credentials)."?d.value=p("form.errorUser"):console.error(`Ошибка: ${e.message}`)}},h=i("password"),N=()=>{h.value=h.value==="password"?"text":"password"},S=Y(()=>h.value==="password"?"password":"text");return $(()=>a.value,()=>{_.value=!1}),$(()=>r.value,()=>{m.value=!1}),(e,l)=>{const B=R,k=L,P=W;return f(),U("section",se,[s("div",ae,[s("div",te,[A(B)]),s("div",oe,[s("div",re,[s("h1",le,c(t(n)?e.$t("form.login"):e.$t("form.registration")),1),s("div",ie,[s("form",{class:"s-auth__form",onSubmit:q(x,["prevent"])},[s("label",ne,[E(s("input",{"onUpdate:modelValue":l[0]||(l[0]=u=>F(a)?a.value=u:a=u),class:I(["s-auth__form-input s-auth__form-input-email",{_error:t(_)}]),type:"text",placeholder:e.$t("form.email")},null,10,ue),[[J,t(a),void 0,{trim:!0}]])]),s("label",ce,[E(s("input",{"onUpdate:modelValue":l[1]||(l[1]=u=>F(r)?r.value=u:r=u),class:I(["s-auth__form-input s-auth__form-input-password",{_error:t(m)}]),type:t(h),placeholder:e.$t("form.password")},null,10,_e),[[K,t(r),void 0,{trim:!0}]]),s("div",{class:"s-auth__form-input-right",onClick:N},[t(S)==="password"?(f(),M(k,{key:0,icon:"mdi-eye-outline"})):(f(),M(k,{key:1,icon:"mdi-eye-off-outline"}))])]),s("button",me,c(t(n)?e.$t("form.login"):e.$t("form.registration")),1),t(v)?(f(),U("div",de,[s("p",he,c(t(d)),1)])):G("",!0)],32),s("div",fe,[s("span",pe,c(e.$t("form.or")),1),s("button",{class:"s-auth__button",onClick:D},c(t(n)?e.$t("form.registration"):e.$t("form.login")),1)])])])]),s("div",ve,[A(P)])])])}}};export{$e as default};
